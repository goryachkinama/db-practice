---
title: Лабораторная работа 3
---

[Таблица стран](assets/lab3/Страны.xlsx)

[К списку лабораторных >>>](../README.md)

---

### Часть 3. Задания по объединению однотипных запросов в таблицах со странами

1. Вывести объединенный результат выполнения запросов, которые выбирают страны с площадью меньше 500 кв. км и с площадью больше 5 млн. кв. км.
2. Вывести список стран с площадью больше 1 млн. кв. км, исключить страны с населением меньше 100 млн. чел.
3. Вывести список стран с площадью меньше 500 кв. км и с населением меньше 100 тыс. чел.

---

### [Объединение однотипных запросов, UNION](https://metanit.com/sql/sqlserver/7.5.php)

Для объединения результатов двух или более запросов в одну таблицу используется команда UNION.
Команда UNION объединяет вывод двух или более запросов в единый набор 
строк и столбцов и имеет вид:

```sql
SELECT_выражение1
UNION [ALL] SELECT_выражение2
[UNION [ALL] SELECT_выражениеN]
```

Для объединения результатов нескольких запросов с помощью UNION, они должны соответствовать следующим требованиям:
* содержать одинаковое количество столбцов;
* типы данных столбцов должны совпадать во всех запросах;
* в промежуточных запросах нельзя использовать сортировку ORDER BY.

Чтобы отсортировать результат объединения, в конце запроса добавляется ORDER BY.
Названия столбцов в запросах могут отличаться. Поэтому в команде ORDER BY указывается название столбцов с первого запроса.

Важно! Если объединяемые наборы содержат в строках идентичные значения, то при объединении повторяющиеся строки удаляются.

! Если необходимо при объединении сохранить повторяющиеся строки, то для этого используется параметр ALL.

Все запросы выполняются независимо друг от друга, а уже их вывод объединяется.
В объединяемых запросах можно использовать одну и ту же таблицу.

---


### [Разность двух выборок, EXCEPT](https://metanit.com/sql/sqlserver/7.6.php)

Чтобы найти разность двух выборок, то есть те строки, которые есть в первой выборке, но которых нет во второй, 
используется команда EXCEPT. Она имеет следующий вид:

```sql 
SELECT_выражение1
EXCEPT SELECT_выражение2
```

Возвращаются все различные значения, указанные слева от оператора EXCEPT.
Эти значения возвращаются, если они отсутствуют в результатах выполнения правого запроса.
Требования к использованию команды EXCEPT такие же, как к команде UNION.
Если сравниваются значения столбцов с целью определения различных строк, два значения NULL считаются равными.

---

### [Общее в двух выборках, INTERSECT](https://metanit.com/sql/sqlserver/7.7.php)

Команда INTERSECT позволяет найти общие строки в результатах двух запросов, 
то есть данный оператор выполняет операцию пересечения множеств. Команда INTERSECT имеет следующий вид:

```sql 
SELECT_выражение1
INTERSECT SELECT_выражение2
```

Требования к использованию команды INTERSECT такие же, как к командам UNION и EXCEPT.

---

    ) A
)
```
