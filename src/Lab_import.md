# Знакомство с MS SQL Server. Заполнение таблиц

![first slide](assets/lab00/toy_story.png)

[все лабораторные](https://github.com/goryachkinama/db-practice/README.md)

---
### Задание:

Импортировать в базу следующие таблицы:


[Таблица стран](assets/lab3/Страны.xlsx)

[Таблица учеников](assets/lab5/Pupils.xlsx)

[Таблицы студентов](assets/lab6/Students.xlsx)


При необходимости прокинуть связи через конструктор

---
### Заполнение таблиц в MS SQL Server можно выполнить следующими способами:

1. Внесение данных вручную
2. Импорт данных из MS Excel
3. Копирование данных из MS Excel
4. Скриптами с инструкциями INSERT VALUES

---
### Внесение данных вручную

Management Studio в режиме конструктора поддерживает внесение и корректировку данных.

Для этого нужно выполнить следующие действия:

1. Кликом правой кнопки мыши по названию таблицы открыть контекстное меню
2. Выбрать "Изменить первые 200 строк"
3. Откроется вкладка с данными таблицы, которые можно вводить вручную в соответствующую ячейку
4. Данные сохраняются только при переходе на другую строку (последующую либо одну из предыдущих)
5. При вводе некорректных значений буду показаны сообщения об ошибке и приложение не даст переместить курсор на другую строку (и не сохранит изменения)
6. В случае большого количества ошибок изменения можно откатить закрытием вкладки и выбором "Очистить результаты" (ничего лишнего при этом не очистится)

---

### Импорт данных из MS Excel

Management Studio поддерживает заливку данных из электронных таблиц MS Excel.

Для загрузки из файла нужно выполнить следующие действия:

1. Кликом правой кнопки мыши по названию базы данных открыть контекстное меню
2. Выбрать Задачи --> Импорт данных (в самом низу)

![image](https://github.com/user-attachments/assets/8c377e9b-8442-4660-a061-fe16fe360681)

3. В появившемся окне пройти далее (выбрать Next>)
4. В качестве источника указать Microsoft Excel, по клику на кнопку "Обзор" выбрать нужный *.xlsx-файл и пройти далее (выбрать Next>)

![image](https://github.com/user-attachments/assets/a161b5b0-396e-4688-a04d-d41c1dd82b3e)

5. В назначени указать Provider for SQL Server, выбрать нужный сервер и базу данных, в которую будет осуществляться загрузка и пройти далее (выбрать Next>)

![image](https://github.com/user-attachments/assets/b7a3eb35-feae-448e-9f96-2a4f2d079c54)

6. Пройти далее (выбрать Next>)
7. Выбрать необходимые листы для загрузки и указать названия таблиц, в которые будут загружены данные с этих листов (названия можно оставить такими, какие есть и изменить позже),  и пройти далее (выбрать Next>)
![image](https://github.com/user-attachments/assets/022e528e-7196-4e77-ac3d-afcd11f3c889)
 
8. Пройти далее (выбрать Next>)
9. Finish. Ура!

---

### Копирование данных из MS Excel

Иногда удобнее и быстрее просто скопировать необходимые данные в таблицу.
Для этого нужно выполнить следующие действия:

1. Корректно подготовить таблицы на листах MS Excel, чтобы порядок столбцов и типы данных в них строго совпадали с порядком столбцов таблицы в Management Studio
2. Столбцы с автозаполнением нужно оставить пустыми, но включить в копирование
3. Выделяем нужную область (вместе с автозаполняемыми "пустыми" столбцами)
   Выделять большие области в MS Excel удобно с помощью сочетаний клавиш:
   * Shift + Ctrl + стрелка вправо = Выделить ячейки от текущей позиции до конца заполненных ячеек вправо
   * Shift + Ctrl + стрелка вниз = Выделить ячейки от текущей позиции до конца заполненных ячеек вниз
   * Shift + Ctrl + End = Выделить весь диапазон
   * Home = Перейти в начало строки
   * End = Перейти в конец строки
   * Ctrl + End = Перейти на последнюю строку таблицы
   * Ctrl + Home = Перейти вверх в начало листа
5. Клик правой кнопки мыши --> Копировать / Правка --> Копировать / Shift+Insert / Ctrl+C
6. Кликом правой кнопки мыши по названию таблицы открыть контекстное меню
7. Выбрать "Изменить первые 200 строк"
8. Выделяем всю последнюю строку (кликом на серую ячейку слева с символом *)
9. Клик правой кнопки мыши --> Вставить / Ctrl+Insert / Ctrl+V 

---

[Следующие задания >>>](Lab0.md)

[К списку лабораторных >>>](../README.md)
